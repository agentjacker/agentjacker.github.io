<!DOCTYPE html>
<html>
<head><title>Toxic DOM</title></head>
<body>
  <script>
    // The malicious payload to be executed by eval
    var maliciousPayload = '{ "isActive": true; alert("XSS Vulnerability Exploited!"); }';

    var postMessageHandler = function(msg) {
      var content = msg.data;
      var msgObj = eval(content);

      if (msgObj.isActive) {
        document.write("PostMessage arrived!");
      }
    }

    window.addEventListener('message', postMessageHandler, false);

    // Sending the malicious postMessage to trigger the exploit
    window.parent.postMessage('<script>prompt()</script>', '*');
  </script>
</body>
</html>
