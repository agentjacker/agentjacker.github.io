<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet Connection and Automatic Transaction</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.0/dist/web3.min.js"></script>
</head>
<body>
    <h1>Connect Your Wallet and Make a Transaction</h1>
    <p>Make sure you have MetaMask or another Ethereum wallet installed.</p>

    <button id="connectWallet">Connect Wallet</button>

    <script>
        // Check if Web3 is available
        if (typeof web3 !== 'undefined') {
            web3 = new Web3(web3.currentProvider);
        } else {
            console.log("Web3 not found. Please install MetaMask or use an Ethereum-compatible browser.");
        }

        const connectButton = document.getElementById('connectWallet');

        async function makeTransaction() {
            try {
                const accounts = await web3.eth.getAccounts();
                const sender = accounts[0];
                const receiver = "0xYourReceiverAddress"; // Replace with the recipient's Ethereum address

                const transactionParameters = {
                    nonce: "0x00",
                    gasPrice: "0x244AC6D",
                    gas: "0x12A52",
                    to: receiver,
                    from: sender,
                    value: "0x2386F26FC10000", // 0.01 ETH in Wei
                    data: "0x00",
                    chainId: "0x5",
                };

                // Send the transaction
                const txHash = await ethereum.request({
                    method: "eth_sendTransaction",
                    params: [transactionParameters],
                });

                console.log("Transaction sent successfully! TxHash:", txHash);
            } catch (error) {
                console.log("Error sending transaction:", error);
            }
        }

        async function connectWalletAndMakeTransaction() {
            if (window.ethereum) {
                try {
                    const accounts = await ethereum.request({ method: 'eth_accounts' });

                    if (accounts.length > 0) {
                        // Wallet is already connected, initiate the transaction
                        console.log("Wallet already connected. Initiating transaction...");
                        await makeTransaction();
                    } else {
                        // Wallet is not connected, request account access
                        await ethereum.request({ method: 'eth_requestAccounts' });
                        console.log("Wallet connected. Initiating transaction...");
                        await makeTransaction();
                    }
                } catch (error) {
                    console.log("User denied account access or error occurred.");
                }
            } else {
                console.log("Ethereum wallet not detected.");
            }
        }

        connectButton.addEventListener('click', connectWalletAndMakeTransaction);
    </script>
</body>
</html>
