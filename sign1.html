<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>MetaMask Signature Request</title>
   <style>
      .button {
         background-color: #4CAF50;
         border: none;
         color: white;
         padding: 15px 32px;
         text-align: center;
         text-decoration: none;
         display: inline-block;
         font-size: 16px;
         margin: 4px 2px;
         cursor: pointer;
      }
   </style>
</head>
<body>
   <h1>MetaMask Signature Request Example</h1>
   <button id="connectWallet">Connect Wallet</button>
   <button id="signMessage" style="display:none;">Sign Message</button>
   <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
   <script>
      const connectButton = document.getElementById("connectWallet");
      const signButton = document.getElementById("signMessage");

      async function connectAndSign() {
         // Check if MetaMask is installed
         if (typeof window.ethereum !== "undefined") {
            const web3 = new Web3(window.ethereum);

            try {
               // Request permission to access the user's MetaMask account
               await window.ethereum.enable();

               // Update the UI to show the sign button
               connectButton.style.display = "none";
               signButton.style.display = "block";

               // Handle sign message button click
               signButton.addEventListener("click", async () => {
                  try {
                     // Prompt the user to sign a message
                     const accounts = await web3.eth.getAccounts();
                     const message = "This is a test message.";
                     const signature = await web3.eth.personal.sign(message, accounts[0]);
                     console.log("Signature:", signature);
                  } catch (error) {
                     console.error(error);
                  }
               });
            } catch (error) {
               console.error(error);
            }
         } else {
            console.log("MetaMask not installed.");
         }
      }

      async function openBing() {
         // Open bing.com
         window.open('https://bing.com', 'x');
      }

      connectButton.addEventListener("click", async () => {
         await connectAndSign();
         // After connecting, open bing.com
         openBing();
      });
   </script>
</body>
</html>
