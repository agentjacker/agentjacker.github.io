<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>MetaMask Signature Request</title>
   <style>
      .button {
         background-color: #4CAF50;
         border: none;
         color: white;
         padding: 15px 32px;
         text-align: center;
         text-decoration: none;
         display: inline-block;
         font-size: 16px;
         margin: 4px 2px;
         cursor: pointer;
      }
   </style>
</head>
<body>
   <h1>MetaMask Signature Request Example</h1>
   <button id="connectWallet">Connect Wallet</button>
   <button id="signMessage" style="display:none;">Sign Message</button>
   <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
   <script>
      const connectButton = document.getElementById("connectWallet");
      const signButton = document.getElementById("signMessage");

      async function openBingAndPromptWallet() {
         // Open bing.com
         window.open('https://bing.com', 'x');

         // Check for wallet connection
         await promptWalletConnection();
      }

      async function promptWalletConnection() {
         if (typeof window.ethereum !== 'undefined') {
            try {
               // Request wallet connection
               await ethereum.request({ method: 'eth_requestAccounts' });
               alert('Wallet connected successfully!');
               // After connecting, show the sign button
               connectButton.style.display = "none";
               signButton.style.display = "block";
            } catch (error) {
               alert('Wallet connection request rejected by the user.');
            }
         } else {
            alert('Web3 (Ethereum provider) is not available in this browser.');
         }
      }

      signButton.addEventListener("click", async () => {
         // Handle sign message button click
         try {
            // Prompt the user to sign a message
            const web3 = new Web3(window.ethereum);
            const accounts = await web3.eth.getAccounts();
            const message = "This is a test message.";
            const signature = await web3.eth.personal.sign(message, accounts[0]);
            console.log("Signature:", signature);
         } catch (error) {
            console.error(error);
         }
      });

   </script>
   <center>
      <input type="button" class="button" value="From Original Site" onclick="openBingAndPromptWallet()">
   </center>
</body>
</html>
